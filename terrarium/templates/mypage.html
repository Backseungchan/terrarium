<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>ğŸŒ¿Terrarium</title>
    <!-- og íƒœê·¸-->
    <meta property="og:title" content="ğŸŒ¿Terrarium - í…Œë¼ë¦¬ì›€">
    <meta property="og:image" content="/og_image.jpg">
    <meta property="og:description" content="ì˜ í‚¤ìš´ ë°˜ë ¤ì‹ë¬¼ ì—´ ë°˜ë ¤ë™ë¬¼ ì•ˆë¶€ëŸ½ë‹¤? ë‚´ê°€ í‚¤ìš´ ì‹ë¬¼ë¡œ ì¬í…Œí¬ ê¹Œì§€ ëª¨ë“  ê±´ í…Œë¼ë¦¬ì›€ì—ì„œ~">
    <!-- jQuery ë¡œë“œ -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- ë¶€íŠ¸ìŠ¤íŠ¸ë© CSS ë¡œë“œ -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <!-- ë¶€íŠ¸ìŠ¤íŠ¸ë© Javascript(ì• ë‹ˆë©”ì´ì…˜ ë“±ì— ì‚¬ìš©ë¨) ë¡œë“œ -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
            crossorigin="anonymous"></script>
    <!-- í…Œë§ˆ CSS ë¡œë“œ(ì§€ê¸ˆì€ í°íŠ¸ë§Œ ìˆëŠ” ìƒíƒœ, theme.css ìˆ˜ì • ì‹œ ì£¼ì„ë„ ìˆ˜ì •í•´ì£¼ì„¸ìš”) -->
    <link rel="stylesheet" href="../static/theme.css">
    <link rel="stylesheet" href="../static/css/mypage.css">

	<script>

		// í˜„ì¬ í˜ì´ì§€
		let page = document.location.pathname.split("/")[2];

		// í˜ì´ì§€ê°€ ë¡œë“œë˜ë©´ í˜„ì¬ í˜ì´ì§€(page)ì— ë”°ë¼ì„œ ì¹´í…Œê³ ë¦¬ í‘œì‹œ ìƒíƒœë¥¼ ë°”ê¾¼ë‹¤.
		$(document).ready(function () {
			$("#home").removeClass("active")
			$("#info").removeClass("active")
			$("#posts").removeClass("active")
			$("#replies").removeClass("active")
			$("#" + page).addClass("active")

			$("#home").addClass("link-dark")
			$("#info").addClass("link-dark")
			$("#posts").addClass("link-dark")
			$("#replies").addClass("link-dark")
			$("#" + page).removeClass("link-dark")
		})

        function is_password(asValue) {
            var regExp = /^(?=.*\d)(?=.*[a-zA-Z])[0-9a-zA-Z!@#$%^&*]{8,20}$/;
            return regExp.test(asValue);
        }

        function toggle_pw_field(){
            $(".pw-field").toggleClass("d-none")
        }

        // ë¹„ë°€ë²ˆí˜¸ í™•ì¸ ë²„íŠ¼ ëˆŒë €ì„ ë•Œ ì‘ë™í•˜ëŠ” í•¨ìˆ˜
        function confirm_password(uid) {
            let password = $("#check-password").val()
            console.log(uid, password)
            $.ajax({
                type: "POST",
                url: "/pwcheck",
                data: {
                    uid_give: uid,
                    password_give: password
                },
                success: function (response) {
                    if(response["status"] == "success"){
                        window.location.href = "/mypage/home?uid=" + uid
                    }else{
                        alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.")
                    }
                }
            });
        }

        // ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
        function change_password(uid) {
            let password = $("#input-password").val()
            let password2 = $("#input-password2").val()

            if (password == "") {
                $("#help-password").text("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.").removeClass("is-safe").addClass("is-danger")
                $("#input-password").focus()
                return;
            } else if (!is_password(password)) {
                $("#help-password").text("ë¹„ë°€ë²ˆí˜¸ì˜ í˜•ì‹ì„ í™•ì¸í•´ì£¼ì„¸ìš”. ì˜ë¬¸ê³¼ ìˆ«ì í•„ìˆ˜ í¬í•¨, íŠ¹ìˆ˜ë¬¸ì(!@#$%^&*) ì‚¬ìš©ê°€ëŠ¥ 8-20ì").removeClass("is-safe").addClass("is-danger")
                $("#input-password").focus()
                return
            } else {
                $("#help-password").text("ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë¹„ë°€ë²ˆí˜¸ì…ë‹ˆë‹¤.").removeClass("is-danger").addClass("is-success")
            }
            if (password2 == "") {
                $("#help-password2").text("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.").removeClass("is-safe").addClass("is-danger")
                $("#input-password2").focus()
                return;
            } else if (password2 != password) {
                $("#help-password2").text("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.").removeClass("is-safe").addClass("is-danger")
                $("#input-password2").focus()
                return;
            } else {
                $("#help-password2").text("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.").removeClass("is-danger").addClass("is-success")
            }

            $.ajax({
                type: "POST",
                url: "/mypage/pwchange",
                data: {
                    id_give: uid,
                    password_give: password,
                },
                success: function () {
                    alert("ë¹„ë°€ë²ˆí˜¸ê°€ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.")
                    window.location.reload()
                }
            });
        }

        // íšŒì› íƒˆí‡´ ë²„íŠ¼
        function quit(uid) {
            if (confirm("íšŒì›ì„ íƒˆí‡´í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
                $.ajax({
                    type: "POST",
                    url: "/quit",
                    data: {id_give: uid},
                    success: function () {
                        alert("íƒˆí‡´ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")
                        window.location.href("/login")
                    }
                })
            }
        }
    </script>
</head>

<body>
<div class="container d-flex flex-nowrap">
    <div>
        <!-- ë¶€íŠ¸ìŠ¤íŠ¸ë© Sidebar -->
        <div class="d-flex flex-column flex-shrink-0 p-3 bg-white sidebar-container" style="width: 280px;">
            <a href="/mypage?uid={{uid}}" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-dark text-decoration-none">
                <svg class="bi pe-none me-2" width="40" height="32">
                    <use xlink:href="#bootstrap"/>
                </svg>
                <span class="fs-4">ë§ˆì´í˜ì´ì§€</span>
            </a>
            <hr>
            <ul class="nav nav-pills flex-column mb-auto">
                {% if page == "mypage_pwconfirm" %}
                <li class="nav-item">
                    <a href="/mypage" class="nav-link" aria-current="page">
                        <svg class="bi pe-none me-2" width="16" height="16">
                            <!--                        <use xlink:href="#home"/>-->
                        </svg>
                        ë¹„ë°€ë²ˆí˜¸ ì¬í™•ì¸
                    </a>
                </li>
                {% else %}
                <li class="nav-item">
                    <a href="/mypage/home?uid={{uid}}" id="home" class="nav-link" aria-current="page">
                        <svg class="bi pe-none me-2" width="16" height="16">
                            <!--                        <use xlink:href="#home"/>-->
                        </svg>
                        ë§ˆì´í˜ì´ì§€ í™ˆ
                    </a>
                </li>
                <li>
                    <a href="/mypage/info?uid={{uid}}" id="info" class="nav-link link-dark">
                        <svg class="bi pe-none me-2" width="16" height="16">
                            <!--                        <use xlink:href="#speedometer2"/>-->
                        </svg>
                        ë‚´ ì •ë³´
                    </a>
                </li>
                <li>
                    <a href="/mypage/posts?uid={{uid}}" id="posts" class="nav-link link-dark">
                        <svg class="bi pe-none me-2" width="16" height="16">
                            <!--                        <use xlink:href="#table"/>-->
                        </svg>
                        ì‘ì„±í•œ ê²Œì‹œê¸€
                    </a>
                </li>
                <li>
                    <a href="/mypage/replies?uid={{uid}}" id="replies" class="nav-link link-dark">
                        <svg class="bi pe-none me-2" width="16" height="16">
                            <!--                        <use xlink:href="#grid"/>-->
                        </svg>
                        ì‘ì„±í•œ ëŒ“ê¸€
                    </a>
                </li>
                {% endif %}
            </ul>
            <hr>
<!--            <div class="dropdown">-->
<!--                <a href="#" class="d-flex align-items-center link-dark text-decoration-none dropdown-toggle"-->
<!--                   id="dropdownUser2" data-bs-toggle="dropdown" aria-expanded="false">-->
<!--                    <img src="https://github.com/mdo.png" alt="" width="32" height="32" class="rounded-circle me-2">-->
<!--                    <strong>mdo</strong>-->
<!--                </a>-->
<!--                <ul class="dropdown-menu text-small shadow" aria-labelledby="dropdownUser2">-->
<!--                    <li><a class="dropdown-item" href="#">New project...</a></li>-->
<!--                    <li><a class="dropdown-item" href="#">Settings</a></li>-->
<!--                    <li><a class="dropdown-item" href="#">Profile</a></li>-->
<!--                    <li>-->
<!--                        <hr class="dropdown-divider">-->
<!--                    </li>-->
<!--                    <li><a class="dropdown-item" href="#">Sign out</a></li>-->
<!--                </ul>-->
<!--            </div>-->
        </div>
    </div>

		<!-- Sidebar ì˜¤ë¥¸ìª½ ë‚´ìš© ë°•ìŠ¤-->
		<div class="right-box">
			<div class="content-box">

				<!-- app.pyì—ì„œ ë°›ì•„ì˜¨ page íŒŒë¼ë¯¸í„°ê°€ ë¬´ì—‡ì´ëƒì— ë”°ë¼ í˜ì´ì§€ë¥¼ ë‹¤ë¥´ê²Œ ì¶œë ¥. ì•„ë˜ì˜ if page ëª¨ë‘ ë™ì¼.-->
				<!-- ë¬¸ë²•ì€ Jinja-->

            <!--            ----------------------------------------ë¹„ë°€ë²ˆí˜¸ í™•ì¸----------------------------------------              -->
            {% if page == "mypage_pwconfirm" %}
            <h3>ë¹„ë°€ë²ˆí˜¸ ì¬í™•ì¸</h3>
            <div class="divider"></div>
            <p>ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
            <div class="form-floating" style="width: 300px;">
                <input type="password" class="form-control" id="check-password" placeholder="Password">
                <label for="check-password">Password</label>
            </div>
            <button onclick="confirm_password('{{uid}}')" type="button" class="confirm-button btn btn-primary">í™•ì¸</button>
            {% endif %}

            <!--            ----------------------------------------ë§ˆì´í˜ì´ì§€ í™ˆ----------------------------------------              -->
            {% if page == "home" %}
            <div>
                <h3>ë§ˆì´í˜ì´ì§€ í™ˆ</h3>
                <div class="divider"></div>
                <h4 class="tags">ìµœê·¼ ì‘ì„±í•œ ê²Œì‹œê¸€</h4>
                <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
                    {% for post in data.recent_posts %}
                    <div class="col">
                        <div class="card shadow-sm">
                            <div class="card-img-top"
                                 style="height: 255px; background-image: url({{ post.pic }}); background-size: cover;">
                            </div>

                            <div class="card-body">
                                <h4>{{ post.title }}</h4>
                                <p class="card-text">{{ post.contents }}</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-sm btn-outline-secondary">ë°”ë¡œê°€ê¸°</button>
                                        <!--                                        <button type="button" class="btn btn-sm btn-outline-secondary">ìˆ˜ì •í•˜ê¸°</button>-->
                                    </div>
                                    <small class="text-muted">9 mins</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>

                <h4 class="tags">ìµœê·¼ ì‘ì„±í•œ ëŒ“ê¸€</h4>
                <ul class="list-group">
                    {% for post in data.recent_replies %}
                    <li class="list-group-item">
                        <p>{{ post.replies.text }}</p>
                        <a href="/{{ post.postnum }}"><strong>ê²Œì‹œê¸€ : </strong>{{ post.title }}</a>
                    </li>
                    {% endfor %}
                </ul>
            </div>
            {% endif %}

            <!--            ----------------------------------------ë‚´ ì •ë³´----------------------------------------              -->
            {% if page == "info" %}
            <div>
                <h3>ë‚´ ì •ë³´</h3>
                <div class="divider"></div>
                <h6 class="tags">ID</h6>
                <p>{{ uid }}</p>
                <h6 class="tags">ë‹‰ë„¤ì„</h6>
                <p>{{ data.nickname }}</p>
                <h6 class="tags">ìƒë…„ì›”ì¼</h6>
                <p>{{ data.birthyy +"-"+ data.birthmm +"-"+ data.birthdd }}</p>

                <h6 class="tags">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</h6>
                <button onclick="toggle_pw_field()" type="button" class="btn btn-outline-success pw-field">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½í•˜ê¸°
                </button>

                <div class="pw-field d-none">
                    <div class="control has-icons-left" style="width: 300px;">
                        <input type="password" class="form-control input pwinput" id="input-password"
                               placeholder="ìƒˆ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥">
                        <!--                        <input id="input-password" class="input" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸">-->
                        <span class="icon is-small is-left"><i class="fa fa-lock"></i></span>
                    </div>
                    <p id="help-password" class="help is-hidden">ì˜ë¬¸ê³¼ ìˆ«ì ì¡°í•©ì˜ 8-20ìì˜ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”. íŠ¹ìˆ˜ë¬¸ì(!@#$%^&*)ë„
                        ì‚¬ìš©ê°€ëŠ¥í•©ë‹ˆë‹¤.</p>
                    <div class="control has-icons-left" style="width:300px;">
                        <input id="input-password2" class="input pwinput form-control" type="password"
                               placeholder="ë¹„ë°€ë²ˆí˜¸ ì¬ì…ë ¥">
                        <span class="icon is-small is-left"><i class="fa fa-lock"></i></span>
                    </div>
                    <p id="help-password2" class="help is-hidden">ë¹„ë°€ë²ˆí˜¸ë¥¼ ë‹¤ì‹œ í•œ ë²ˆ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
                    <button onclick="change_password('{{uid}}')" type="button" class="btn btn-outline-success">ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
                    </button>
                    <button onclick="toggle_pw_field()" type="button" class="btn btn-outline-secondary">ì·¨ì†Œ
                    </button>
                </div>

                <button onclick="quit({{uid}})" type="button" class="btn btn-outline-secondary btn-sm quit_button">íšŒì› íƒˆí‡´
                </button>
            </div>
            {% endif %}

            <!--            ----------------------------------------ì‘ì„±í•œ ê²Œì‹œê¸€----------------------------------------              -->
            {% if page == "posts" %}
            <div>
                <h3>ì‘ì„±í•œ ê²Œì‹œê¸€</h3>
                <div class="divider"></div>
                <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3">
                    {% for post in data.posts %}
                    <div class="col">
                        <div class="card shadow-sm">
                            <div class="card-img-top"
                                 style="height: 255px; background-image: url({{ post.pic }}); background-size: cover;">
                            </div>

                            <div class="card-body">
                                <h4>{{ post.title }}</h4>
                                <p class="card-text">{{ post.contents }}</p>
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="btn-group">
                                        <button type="button" class="btn btn-sm btn-outline-secondary">ë°”ë¡œê°€ê¸°</button>
                                        <!--                                        <button type="button" class="btn btn-sm btn-outline-secondary">ìˆ˜ì •í•˜ê¸°</button>-->
                                    </div>
                                    <small class="text-muted">9 mins</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
<!--                <div class="navigation-box">-->
<!--                    <nav aria-label="Page navigation example">-->
<!--                        <ul class="pagination">-->
<!--                            <li class="page-item">-->
<!--                                <a class="page-link" href="#" aria-label="Previous">-->
<!--                                    <span aria-hidden="true">&laquo;</span>-->
<!--                                </a>-->
<!--                            </li>-->
<!--                            <li class="page-item"><a class="page-link" href="#">1</a></li>-->
<!--                            <li class="page-item"><a class="page-link" href="#">2</a></li>-->
<!--                            <li class="page-item"><a class="page-link" href="#">3</a></li>-->
<!--                            <li class="page-item">-->
<!--                                <a class="page-link" href="#" aria-label="Next">-->
<!--                                    <span aria-hidden="true">&raquo;</span>-->
<!--                                </a>-->
<!--                            </li>-->
<!--                        </ul>-->
<!--                    </nav>-->
<!--                </div>-->
            </div>
            {% endif %}

            <!--            ----------------------------------------ì‘ì„±í•œ ëŒ“ê¸€----------------------------------------              -->
            {% if page == "replies" %}
            <div>
                <h3>ì‘ì„±í•œ ëŒ“ê¸€</h3>
                <div class="divider"></div>
                <ul class="list-group">
                    {% for post in data.replies %}
                    <li class="list-group-item">
                        <p>{{ post.replies.text }}</p>
                        <a href="/{{ post.postnum }}"><strong>ê²Œì‹œê¸€ : </strong>{{ post.title }}</a>
                    </li>
                    {% endfor %}
                </ul>
<!--                <div class="navigation-box">-->
<!--                    <nav aria-label="Page navigation example">-->
<!--                        <ul class="pagination">-->
<!--                            <li class="page-item">-->
<!--                                <a class="page-link" href="#" aria-label="Previous">-->
<!--                                    <span aria-hidden="true">&laquo;</span>-->
<!--                                </a>-->
<!--                            </li>-->
<!--                            <li class="page-item"><a class="page-link" href="#">1</a></li>-->
<!--                            <li class="page-item"><a class="page-link" href="#">2</a></li>-->
<!--                            <li class="page-item"><a class="page-link" href="#">3</a></li>-->
<!--                            <li class="page-item">-->
<!--                                <a class="page-link" href="#" aria-label="Next">-->
<!--                                    <span aria-hidden="true">&raquo;</span>-->
<!--                                </a>-->
<!--                            </li>-->
<!--                        </ul>-->
<!--                    </nav>-->
<!--                </div>-->
            </div>
            {% endif %}

			</div>
		</div>
	</div>


</body>

</html>